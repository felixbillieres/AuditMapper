<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grep Master - AuditMapper</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/grepmaster.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Bouton pour afficher/masquer la sidebar -->
    <button id="sidebar-toggle" class="sidebar-toggle">
        <i>â˜°</i>
    </button>
    
    <!-- Sidebar UnifiÃ©e -->
    <div id="sidebar" class="sidebar">
        <a href="/index.html" class="sidebar-header">
            <img src="/assets/photos/logo.png" alt="AuditMapper" class="sidebar-logo">
            <div class="sidebar-header-text">
                <h2>AuditMapper</h2>
                <p>Security Assessment Suite</p>
            </div>
        </a>
        
        <div class="sidebar-content">
            <ul class="sidebar-nav">
                <div class="sidebar-category">Management</div>
                <li class="sidebar-nav-item">
                    <a href="/pages/hostmanager.html" class="sidebar-nav-link">
                        <i>ğŸ–¥ï¸</i> Host Manager
                    </a>
                </li>
                
                <div class="sidebar-category">Outils</div>
                <li class="sidebar-nav-item">
                    <a href="/pages/tools.html" class="sidebar-nav-link">
                        <i>ğŸ› ï¸</i> BibliothÃ¨que d'outils
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/file_transfer.html" class="sidebar-nav-link">
                        <i>ğŸ”„</i> Transfert Fichiers
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/pivoting_guide.html" class="sidebar-nav-link">
                        <i>ğŸ”€</i> Pivoting Guide
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/privesc.html" class="sidebar-nav-link">
                        <i>ğŸ”‘</i> Guide Privesc
                    </a>
                </li>
                
                <div class="sidebar-category">Parsers & GÃ©nÃ©rateurs</div>
                <li class="sidebar-nav-item">
                    <a href="/pages/hostsmaker.html" class="sidebar-nav-link">
                        <i>ğŸŒ</i> Config Generator
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/grepmaster.html" class="sidebar-nav-link active">
                        <i>ğŸ”</i> Grep Master
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/vulnreport.html" class="sidebar-nav-link">
                        <i>ğŸ“Š</i> Vuln Report
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Header -->
    <header class="main-header">
        <div class="header-container">
            <div class="header-content">
                <h1>ğŸ” Grep Master</h1>
                <p class="header-subtitle">Analyseur et extracteur de donnÃ©es avancÃ© pour outputs de pentest</p>
            </div>
            <div class="header-controls">
                <div class="language-selector">
                    <button id="languageDropdown" class="language-dropdown">
                        <span class="language-flag">ğŸ‡«ğŸ‡·</span> <span id="currentLanguageText">FR</span>
                    </button>
                    <div id="languageMenu" class="language-menu">
                        <div class="language-option" data-lang="fr">
                            <span class="language-flag">ğŸ‡«ğŸ‡·</span>FranÃ§ais
                        </div>
                        <div class="language-option" data-lang="en">
                            <span class="language-flag">ğŸ‡¬ğŸ‡§</span>English
                        </div>
                    </div>
                </div>
                <button id="toggleTheme" class="theme-toggle">
                    <i class="icon-theme">ğŸŒ“</i>
                </button>
            </div>
        </div>
    </header>

    <!-- Contenu principal -->
    <div class="main-content" id="mainContent">
        <!-- Section d'input -->
        <div class="input-section">
            <div class="input-card">
                <div class="input-header">
                    <h2>ğŸ“¥ DonnÃ©es Ã  Analyser</h2>
                    <div class="input-controls">
                        <button id="refreshAnalysis" class="btn btn-primary">ğŸ”„ Analyser</button>
                        <button id="clearInput" class="btn btn-secondary">ğŸ—‘ï¸ Vider</button>
                        <button id="loadSample" class="btn btn-secondary">ğŸ“‹ Exemple</button>
                    </div>
                </div>
                
                <div class="input-body">
                    <div class="input-main">
                        <div class="input-config">
                            <div class="config-row">
                                <div class="config-item">
                                    <label for="outputType">Type d'output:</label>
                                    <select id="outputType">
                                        <option value="auto">ğŸ” DÃ©tection automatique</option>
                                        <option value="secretsdump">ğŸ” Secretsdump</option>
                                        <option value="mimikatz">ğŸ¯ Mimikatz</option>
                                        <option value="sam">ğŸ’¾ SAM Dump</option>
                                        <option value="lsass">ğŸ§  LSASS Dump</option>
                                        <option value="rpcclient">ğŸ”— RPC Client</option>
                                        <option value="ldap">ğŸ“ LDAP</option>
                                        <option value="passwd">ğŸ‘¥ /etc/passwd</option>
                                        <option value="shadow">ğŸ”’ /etc/shadow</option>
                                        <option value="nmap">ğŸŒ Nmap</option>
                                        <option value="generic">ğŸ“„ GÃ©nÃ©rique</option>
                                    </select>
                                </div>
                                <div class="config-item">
                                    <label>DÃ©tectÃ©:</label>
                                    <span id="detectedType" class="detected-type">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <textarea 
                            id="rawOutput" 
                            placeholder="Collez ici vos outputs de pentest (secretsdump, mimikatz, etc.)..."
                            rows="15"
                        ></textarea>
                    </div>
                    
                    <div class="input-stats">
                        <div class="stat-item">
                            <span class="stat-label">Lignes:</span>
                            <span id="lineCount" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">CaractÃ¨res:</span>
                            <span id="charCount" class="stat-value">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section d'extraction rapide -->
        <div class="quick-extract-section">
            <div class="quick-extract-card">
                <h3>âš¡ Extraction Rapide</h3>
                <div class="quick-buttons">
                    <button id="extractUsers" class="extract-btn" data-type="users">
                        <div class="btn-icon">ğŸ‘¤</div>
                        <div class="btn-text">
                            <span class="btn-title">Utilisateurs</span>
                            <span class="btn-count" id="usersCount">0</span>
                        </div>
                    </button>
                    
                    <button id="extractHashes" class="extract-btn" data-type="hashes">
                        <div class="btn-icon">ğŸ”</div>
                        <div class="btn-text">
                            <span class="btn-title">Hashes</span>
                            <span class="btn-count" id="hashesCount">0</span>
                        </div>
                    </button>
                    
                    <button id="extractPasswords" class="extract-btn" data-type="passwords">
                        <div class="btn-icon">ğŸ”‘</div>
                        <div class="btn-text">
                            <span class="btn-title">Mots de passe</span>
                            <span class="btn-count" id="passwordsCount">0</span>
                        </div>
                    </button>
                    
                    <button id="extractDomains" class="extract-btn" data-type="domains">
                        <div class="btn-icon">ğŸŒ</div>
                        <div class="btn-text">
                            <span class="btn-title">Domaines</span>
                            <span class="btn-count" id="domainsCount">0</span>
                        </div>
                    </button>
                    
                    <button id="extractIps" class="extract-btn" data-type="ips">
                        <div class="btn-icon">ğŸŒ</div>
                        <div class="btn-text">
                            <span class="btn-title">Adresses IP</span>
                            <span class="btn-count" id="ipsCount">0</span>
                        </div>
                    </button>
                    
                    <button id="extractEmails" class="extract-btn" data-type="emails">
                        <div class="btn-icon">ğŸ“§</div>
                        <div class="btn-text">
                            <span class="btn-title">Emails</span>
                            <span class="btn-count" id="emailsCount">0</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Section d'extraction avancÃ©e -->
        <div class="advanced-extract-section">
            <div class="advanced-extract-card">
                <h3>ğŸ”¬ Extraction AvancÃ©e</h3>
                <div class="advanced-grid">
                    <button id="extractCredentials" class="advanced-btn">
                        <div class="advanced-icon">ğŸ¯</div>
                        <div class="advanced-content">
                            <h4>Credentials Complets</h4>
                            <p>User:Domain:Hash format</p>
                        </div>
                    </button>
                    
                    <button id="extractKerberos" class="advanced-btn">
                        <div class="advanced-icon">ğŸ«</div>
                        <div class="advanced-content">
                            <h4>Tickets Kerberos</h4>
                            <p>TGT/TGS et hashes</p>
                        </div>
                    </button>
                    
                    <button id="extractSecrets" class="advanced-btn">
                        <div class="advanced-icon">ğŸ”’</div>
                        <div class="advanced-content">
                            <h4>Secrets LSA</h4>
                            <p>DPAPI, LSA secrets</p>
                        </div>
                    </button>
                    
                    <button id="extractMachineAccounts" class="advanced-btn">
                        <div class="advanced-icon">ğŸ–¥ï¸</div>
                        <div class="advanced-content">
                            <h4>Comptes Machine</h4>
                            <p>Computer accounts</p>
                        </div>
                    </button>
                    
                    <button id="extractServices" class="advanced-btn">
                        <div class="advanced-icon">âš™ï¸</div>
                        <div class="advanced-content">
                            <h4>Comptes Service</h4>
                            <p>Service accounts</p>
                        </div>
                    </button>
                    
                    <button id="extractPorts" class="advanced-btn">
                        <div class="advanced-icon">ğŸšª</div>
                        <div class="advanced-content">
                            <h4>Ports & Services</h4>
                            <p>Nmap, scan results</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Section de rÃ©sultats -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <div class="results-card">
                <div class="results-header">
                    <div class="results-title">
                        <h3 id="resultsTitle">ğŸ“Š RÃ©sultats</h3>
                        <div class="results-meta">
                            <span id="resultsCount" class="results-count">0 Ã©lÃ©ments</span>
                            <span id="resultsType" class="results-type"></span>
                        </div>
                    </div>
                    
                    <div class="results-controls">
                        <div class="format-selector">
                            <label>Format:</label>
                            <select id="outputFormat">
                                <option value="list">ğŸ“ Liste</option>
                                <option value="hashcat">âš¡ Hashcat</option>
                                <option value="john">ğŸ”¨ John</option>
                                <option value="csv">ğŸ“Š CSV</option>
                                <option value="json">ğŸ”§ JSON</option>
                            </select>
                        </div>
                        
                        <button id="copyResults" class="btn btn-primary">ğŸ“‹ Copier</button>
                        <button id="saveResults" class="btn btn-secondary">ğŸ’¾ Sauvegarder</button>
                        <button id="clearResults" class="btn btn-secondary">ğŸ—‘ï¸ Vider</button>
                    </div>
                </div>
                
                <div class="results-body">
                    <div class="results-tabs">
                        <button class="tab-btn active" data-tab="formatted">ğŸ“‹ FormatÃ©</button>
                        <button class="tab-btn" data-tab="raw">ğŸ“„ Brut</button>
                        <button class="tab-btn" data-tab="stats">ğŸ“Š Statistiques</button>
                    </div>
                    
                    <div class="tab-content">
                        <div id="formattedTab" class="tab-pane active">
                            <div id="formattedResults" class="formatted-results"></div>
                        </div>
                        
                        <div id="rawTab" class="tab-pane">
                            <textarea id="rawResults" readonly></textarea>
                        </div>
                        
                        <div id="statsTab" class="tab-pane">
                            <div id="statsResults" class="stats-results"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section d'historique -->
        <div class="history-section">
            <div class="history-card">
                <div class="history-header">
                    <h3>ğŸ“š Historique des Extractions</h3>
                    <div class="history-controls">
                        <button id="clearHistory" class="btn btn-secondary">ğŸ—‘ï¸ Vider</button>
                        <button id="exportHistory" class="btn btn-secondary">ğŸ“¤ Exporter</button>
                    </div>
                </div>
                
                <div id="historyList" class="history-list">
                    <div class="history-empty">
                        <span class="empty-icon">ğŸ“</span>
                        <p>Aucune extraction pour le moment</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="main-footer">
        <div class="footer-content">
            <p>Made with â¤ï¸ by Elliot Belt - AuditMapper Security Suite</p>
        </div>
    </footer>

    <script src="/assets/js/sidebar.js"></script>
    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/language.js"></script>
    <script src="/assets/js/grepmaster.js"></script>
</body>
</html> 