<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Host Manager Avanc√©</title>
    <!-- Bootstrap CSS (Optionnel) -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- VOTRE CSS EXTERNE -->
    <link rel="stylesheet" href="/assets/css/styles.css">

    <!-- Inclure Vis.js -->
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <!-- Inclure Marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Inclure DOMPurify -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.10/purify.min.js"></script>

    <!-- PAS DE STYLE INTERNE ICI -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

</head>
<body class=""> <!-- La classe dark-theme sera g√©r√©e par theme.js -->

    <!-- Bouton Sidebar Toggle (comme grepmaster.html) -->
    <button id="sidebar-toggle" class="sidebar-toggle">
        <i>‚ò∞</i>
    </button>

    <!-- Sidebar (Structure identique √† grepmaster.html) -->
    <div id="sidebar" class="sidebar">
        <a href="/index.html" class="sidebar-header">
            <h2>Pentest Tools</h2>
            <p>Suite d'outils pour pentest</p>
        </a>
        <div class="sidebar-content">
            <ul class="sidebar-nav">
                <div class="sidebar-category">G√©n√©rateur</div>
            
                <li class="sidebar-nav-item">
                    <!-- Lien Actif -->
                    <a href="/pages/hostmanager.html" class="sidebar-nav-link active">
                        <i>üñ•Ô∏è</i> Host Manager
                    </a>
                </li>
                <div class="sidebar-category">Outils</div>
                <li class="sidebar-nav-item">
                    <a href="/pages/tools.html" class="sidebar-nav-link">
                        <i>üõ†Ô∏è</i> Biblioth√®que d'outils
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/file_transfer.html" class="sidebar-nav-link active">
                        <i>üîÑ</i> Transfert Fichiers <!-- Emoji mis √† jour -->
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/pivoting_guide.html" class="sidebar-nav-link active">
                        <i>üîÄ</i> Pivoting Guide <!-- Emoji mis √† jour -->
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/privesc.html" class="sidebar-nav-link">
                        <i>üîë</i> Guide Privesc
                    </a>
                </li>
                <div class="sidebar-category">Parsers</div>
                <li class="sidebar-nav-item">
                    <a href="/pages/hostsmaker.html" class="sidebar-nav-link">
                        <i>üåê</i> /etc/hosts Maker
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/grepmaster.html" class="sidebar-nav-link">
                        <i>üîç</i> Grep Master
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="/pages/vulnreport.html" class="sidebar-nav-link">
                        <i>üîí</i> Rapport de Vuln√©rabilit√©s
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Header (Structure identique √† grepmaster.html) -->
    <header id="main-header" class="main-header">
        <div class="header-container">
            <!-- Titre sp√©cifique √† la page -->
            <h1>Host Manager Avanc√©</h1>
            <div class="header-controls">
                <!-- S√©lecteur de langue (si vous l'utilisez ici) -->
                <div class="language-selector">
                    <button id="languageDropdown" class="language-dropdown">
                        <i class="icon-language">üåç</i>
                        <span id="currentLanguage">Fran√ßais</span>
                        <i class="dropdown-arrow">‚ñº</i>
                    </button>
                    <div id="languageMenu" class="language-menu">
                        <div class="language-option" data-lang="fr">
                            <span class="language-flag">üá´üá∑</span>Fran√ßais
                        </div>
                        <div class="language-option" data-lang="en">
                            <span class="language-flag">üá¨üáß</span>English
                        </div>
                        <!-- Autres langues -->
                    </div>
                </div>
                <!-- Bouton Th√®me -->
                <button id="toggleTheme" class="theme-toggle">
                    <i class="icon-theme">üåì</i>
                </button>
            </div>
        </div>
    </header>

    <!-- Contenu Principal (Wrapper comme grepmaster.html) -->
    <div id="main-content" class="main-content">

        <!-- ========================================== -->
        <!-- == SECTION EXPORTATION ARBORESCENCE TXT == -->
        <!-- ========================================== -->
        <div id="nodeExportSection" class="card mb-3 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Exporter les Informations des N≈ìuds</h5>
                <p class="card-text small text-muted mb-3">
                    Choisissez une m√©thode d'exportation :
                </p>

                <!-- Option 1: File System Access API -->
                <div class="export-option mb-3 pb-3 border-bottom">
                    <h6>Option 1: Export Direct vers Dossier (Chrome/Edge Recommand√©)</h6>
                    <p class="card-text small text-muted">
                        Cr√©e directement l'arborescence de dossiers et fichiers TXT dans un dossier que vous s√©lectionnez.
                        <strong class="text-warning">N√©cessite votre autorisation explicite.</strong>
                    </p>
                    <div class="d-flex justify-content-start align-items-center flex-wrap">
                        <button type="button" id="selectExportDirBtn" class="btn btn-secondary btn-sm mr-2 mb-2">
                            <i class="icon-folder"></i> Choisir le Dossier Destination...
                        </button>
                        <span id="selectedDirPath" class="mr-3 mb-2 small text-muted">Aucun dossier s√©lectionn√©</span>
                        <button type="button" id="executeNodeExportBtn" class="btn btn-primary btn-sm mb-2" disabled>
                            <i class="icon-download"></i> Exporter vers le Dossier
                        </button>
                    </div>
                </div>

                <!-- Option 2: Export ZIP -->
                <div class="export-option">
                     <h6>Option 2: Export en Archive ZIP (Tous Navigateurs)</h6>
                     <p class="card-text small text-muted">
                        G√©n√®re une archive ZIP contenant l'arborescence compl√®te. Vous devrez ensuite la d√©compresser manuellement.
                    </p>
                    <div class="d-flex justify-content-start align-items-center">
                        <button type="button" id="executeNodeExportZipBtn" class="btn btn-success btn-sm">
                            <i class="icon-archive"></i>
                            G√©n√©rer et T√©l√©charger l'Exportation ZIP
                        </button>
                    </div>
                </div>

                 <span id="nodeExportStatusMsg" class="mt-3 d-block small" style="min-height: 1.2em;"></span>
            </div>
        </div>
        <!-- ========================================== -->
        <!-- == FIN SECTION EXPORTATION ARBORESCENCE == -->
        <!-- ========================================== -->

        <!-- Gestion des Cat√©gories et H√¥tes -->
        <div class="category-section">
            <div class="category-header">
                <h4>Gestion des H√¥tes par Cat√©gorie</h4>
                <button id="addCategoryBtn" class="btn btn-primary btn-sm">
                    <i class="fas fa-plus"></i> Nouvelle Cat√©gorie
                </button>
            </div>
            
            <div class="category-tabs-container">
                <ul id="categoryTabs"></ul>
            </div>
            
            <div id="categoryContentContainer">
                <p class="text-muted text-center">S√©lectionnez une cat√©gorie ou cr√©ez-en une nouvelle pour commencer.</p>
            </div>
        </div>

        <!-- Filtres & Actions Globales (D√âPLAC√â ICI) -->
        <div class="card mb-3"> <!-- Ajout de mb-3 pour l'espacement -->
            <div class="card-header">
                Filtres & Actions
            </div>
            <div class="card-body form-inline flex-wrap">
                <div class="form-group mr-3 mb-2">
                    <label for="filterCategory" class="mr-2">Filtrer par Cat√©gorie:</label>
                    <select id="filterCategory" class="form-control form-control-sm">
                        <option value="">Toutes</option>
                    </select>
                </div>
                <div class="form-group mr-3 mb-2">
                    <label for="filterTag" class="mr-2">Filtrer par Tag:</label>
                    <input type="text" id="filterTag" class="form-control form-control-sm" placeholder="ex: important, todo">
                </div>
                <button id="applyFiltersBtn" class="btn btn-primary btn-sm mr-3 mb-2">Appliquer Filtres</button>

                <div class="ml-auto d-flex flex-wrap">
                    <button id="exportSessionBtn" class="btn btn-success btn-sm mr-2 mb-2">Exporter Session</button>
                    <label for="importSessionInput" class="btn btn-warning btn-sm mr-2 mb-2">Importer Session</label>
                    <input type="file" id="importSessionInput" accept=".json" style="display: none;">
                    <button id="removeAllDataBtn" class="btn btn-danger btn-sm mb-2">Supprimer Toutes les Donn√©es</button>
                </div>
            </div>
        </div>

        <!-- Section Carte R√©seau -->
        <div class="card network-section">
            <div class="card-header">
                <h5 class="mb-0">üó∫Ô∏è Carte R√©seau Interactive</h5>
                <small class="text-muted">Visualisation des syst√®mes et de leurs connexions</small>
            </div>
            
            <div class="network-controls">
                <div class="network-toolbar">
                    <div class="btn-group btn-group-sm">
                        <button id="networkZoomIn" class="btn btn-outline-primary" title="Zoom avant (Ctrl++)">
                            üîç+
                        </button>
                        <button id="networkZoomOut" class="btn btn-outline-primary" title="Zoom arri√®re (Ctrl+-)">
                            üîç-
                        </button>
                        <button id="networkFit" class="btn btn-outline-primary" title="Ajuster √† la vue (F)">
                            üìê Ajuster
                        </button>
                        <button id="networkCenter" class="btn btn-outline-primary" title="Centrer (C)">
                            üéØ Centrer
                        </button>
                    </div>
                    
                    <div class="btn-group btn-group-sm ml-2">
                        <button id="networkPhysics" class="btn btn-outline-success active" title="Simulation physique r√©aliste des mouvements">
                            ‚ö° Physique
                        </button>
                        <button id="networkHierarchy" class="btn btn-outline-info" title="Organisation en arbre hi√©rarchique">
                            üå≥ Hi√©rarchie
                        </button>
                        <button id="networkClustering" class="btn btn-outline-warning" title="Regroupement automatique des nodes similaires">
                            üîó Cluster
                        </button>
                    </div>
                    
                    <div class="input-group input-group-sm ml-2" style="width: 200px;">
                        <input type="text" id="networkSearch" class="form-control" placeholder="Rechercher un node...">
                        <div class="input-group-append">
                            <button id="networkClearSearch" class="btn btn-outline-secondary" type="button" title="Effacer la recherche">
                                ‚ùå
                            </button>
                        </div>
                    </div>
                    
                    <button id="networkFullscreenBtn" class="btn btn-primary btn-sm ml-2" title="Mode plein √©cran (√âchap pour quitter)">
                        üî≥ Plein √©cran
                    </button>
                </div>
                
                <!-- Explications des modes -->
                <div class="network-help-section">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="help-item">
                                <strong>‚ö° Physique :</strong> 
                                <small class="text-muted">Simulation r√©aliste avec forces d'attraction/r√©pulsion. Les nodes bougent naturellement.</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="help-item">
                                <strong>üå≥ Hi√©rarchie :</strong> 
                                <small class="text-muted">Organisation en arbre par cat√©gories. Structure fixe et ordonn√©e.</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="help-item">
                                <strong>üîó Cluster :</strong> 
                                <small class="text-muted">Regroupement automatique des syst√®mes similaires pour simplifier la vue.</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- L√©gende collapsible -->
                <div class="network-legend-integrated">
                    <div class="legend-header" onclick="toggleNetworkLegend()">
                        <h6 class="legend-title mb-0">
                            üìä L√©gende 
                            <span id="legendToggleIcon" class="legend-toggle-icon">‚ñº</span>
                        </h6>
                        <small class="text-muted">Cliquer pour √©tendre/r√©duire</small>
                    </div>
                    
                    <div id="legendContent" class="legend-content">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="legend-section">
                                    <h6 class="legend-subtitle">üéØ Niveau de compromission (bordure)</h6>
                                    <div class="legend-items-grid">
                                        <div class="legend-item">
                                            <span class="legend-border-demo" style="border: 3px solid #95a5a6;"></span>
                                            <span>Non compromis</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-border-demo" style="border: 4px solid #f1c40f;"></span>
                                            <span>Faible</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-border-demo" style="border: 5px solid #e67e22;"></span>
                                            <span>Moyen</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-border-demo" style="border: 6px solid #e74c3c;"></span>
                                            <span>√âlev√©</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-border-demo" style="border: 7px solid #8e44ad;"></span>
                                            <span>Critique</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="legend-section">
                                    <h6 class="legend-subtitle">Ô∏è Types de syst√®mes (ic√¥ne)</h6>
                                    <div class="legend-items-grid">
                                        <div class="legend-item">
                                            <span>üñ• Windows</span>
                                            <span>üêß Linux</span>
                                            <span>üèõ DC</span>
                                        </div>
                                        <div class="legend-item">
                                            <span>üåê Web</span>
                                            <span>üóÑ Database</span>
                                            <span>üì° Router</span>
                                        </div>
                                        <div class="legend-item">
                                            <span>üõ° Firewall</span>
                                            <span>üíª Workstation</span>
                                            <span>‚ùì Autre</span>
                                        </div>
                                    </div>
                                    <div class="mt-2">
                                        <small class="text-muted">
                                            üí° <strong>Couleur de fond :</strong> Cat√©gorie | 
                                            <strong>Bordure :</strong> Niveau de compromission
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="network-controls-help">
                            <small class="text-muted">
                                üí° <strong>Raccourcis :</strong> F (ajuster), C (centrer), P (physique), H (hi√©rarchie), Ctrl+/- (zoom) | 
                                <strong>Interactions :</strong> Clic droit sur un node pour le menu contextuel, glisser pour d√©placer
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="networkContainer"></div>
            
            <!-- Panneau d'informations du node s√©lectionn√© -->
            <div id="nodeInfoPanel" class="node-info-panel" style="display: none;">
                <div class="node-info-header">
                    <h6 id="nodeInfoTitle">Informations du Node</h6>
                    <button id="closeNodeInfo" class="btn btn-sm btn-outline-secondary">‚úï</button>
                </div>
                <div id="nodeInfoContent" class="node-info-content">
                    <!-- Contenu dynamique -->
                </div>
            </div>
        </div>

        <!-- Donn√©es Agr√©g√©es -->
        <div class="card aggregated-data-section mt-3"> <!-- Ajout de mt-3 -->
            <div class="card-header">
                Donn√©es Agr√©g√©es (Cliquer pour copier)
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <h5>Usernames</h5>
                        <pre id="allUsernames" class="copyable-data" title="Cliquer pour copier"></pre>
                    </div>
                    <div class="col-md-4">
                        <h5>Passwords</h5>
                        <pre id="allPasswords" class="copyable-data" title="Cliquer pour copier"></pre>
                    </div>
                    <div class="col-md-4">
                        <h5>Hashes</h5>
                        <pre id="allHashes" class="copyable-data" title="Cliquer pour copier"></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section Rapports -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üìä G√©n√©ration de Rapports</h5>
                <small class="text-muted">Cr√©ez des rapports d√©taill√©s de vos activit√©s</small>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-8">
                        <div class="report-controls">
                            <h6>üéØ Types de rapports disponibles</h6>
                            <div class="btn-group mb-3" role="group">
                                <button type="button" id="generateExecutiveSummary" class="btn btn-primary">
                                    üìã R√©sum√© Ex√©cutif
                                </button>
                                <button type="button" id="generateTechnicalReport" class="btn btn-info">
                                    üîß Rapport Technique
                                </button>
                                <button type="button" id="generateKillChainReport" class="btn btn-warning">
                                    ‚öîÔ∏è Kill Chain
                                </button>
                                <button type="button" id="generateCredentialReport" class="btn btn-success">
                                    üîë Credentials
                                </button>
                            </div>
                            
                            <div class="report-options">
                                <h6>‚öôÔ∏è Options de g√©n√©ration</h6>
                                <div class="form-row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="reportTitle">Titre du rapport</label>
                                            <input type="text" id="reportTitle" class="form-control" 
                                                   placeholder="Pentest - [Client] - [Date]">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="reportAuthor">Auteur</label>
                                            <input type="text" id="reportAuthor" class="form-control" 
                                                   placeholder="Nom du pentester">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>üìÅ Cat√©gories √† inclure</label>
                                    <div id="reportCategoryFilters" class="category-filters">
                                        <!-- G√©n√©r√© dynamiquement -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="report-preview-card">
                            <h6>üëÅÔ∏è Aper√ßu en temps r√©el</h6>
                            <div id="reportPreviewMini" class="report-preview-mini">
                                <div class="text-center text-muted p-3">
                                    <i class="fas fa-file-alt fa-2x mb-2"></i>
                                    <p>S√©lectionnez un type de rapport pour voir l'aper√ßu</p>
                                </div>
                            </div>
                            
                            <div class="report-actions mt-3">
                                <button type="button" id="previewFullReport" class="btn btn-outline-primary btn-sm btn-block" disabled>
                                    üëÅÔ∏è Aper√ßu complet
                                </button>
                                <div class="btn-group btn-group-sm w-100 mt-2">
                                    <button type="button" id="exportReportPdf" class="btn btn-success" disabled>
                                        üìÑ PDF
                                    </button>
                                    <button type="button" id="exportReportMd" class="btn btn-info" disabled>
                                        üìù Markdown
                                    </button>
                                    <button type="button" id="exportReportHtml" class="btn btn-warning" disabled>
                                        üåê HTML
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- Fin #main-content -->

    <!-- Panneau d'√âdition H√¥te (Initialement cach√©) -->
    <!-- Plac√© HORS de main-content pour un positionnement fixe plus fiable -->
    <div id="editPanel" class="edit-panel">
        <!-- AJOUT DU BOUTON POUR AGRANDIR/R√âDUIRE -->
        <button id="toggleWidePanelBtn" class="toggle-wide-btn" title="Agrandir/R√©duire">‚ÜîÔ∏è</button>
        <button id="closePanelBtn" class="close-panel-btn" title="Fermer">&times;</button>
        <h3>√âditer H√¥te</h3>
        <form id="editHostForm">
            <input type="hidden" id="editHostId">
            <input type="hidden" id="editHostCategory">

            <div class="form-group">
                <label for="editHostIpName">IP / Nom d'h√¥te:</label>
                <input type="text" id="editHostIpName" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="editHostServices">Services (s√©par√©s par virgule):</label>
                <input type="text" id="editHostServices" class="form-control">
            </div>
            <div class="form-group">
                <label for="editHostNotes">Notes:</label>
                <textarea id="editHostNotes" class="form-control" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label for="editHostTags">Tags (s√©par√©s par virgule):</label>
                <input type="text" id="editHostTags" class="form-control">
            </div>

            <!-- === NOUVEAUX CHAMPS === -->
            <div class="form-group">
                <label for="editHostSystem">Syst√®me (OS/Type):</label>
                <select id="editHostSystem" class="form-control">
                    <option value="" selected>-- Non Sp√©cifi√© --</option>
                    <option value="Linux">Linux</option>
                    <option value="Windows">Windows (Client/Serveur)</option>
                    <option value="Active Directory">Active Directory (DC)</option>
                    <option value="macOS">macOS</option>
                    <option value="Other">Autre</option>
                </select>
            </div>
            <div class="form-group">
                <label for="editHostRole">R√¥le:</label>
                <input type="text" id="editHostRole" class="form-control" placeholder="ex: Domain Controller, Web Server...">
            </div>
            <div class="form-group">
                <label for="editHostZone">Zone R√©seau:</label>
                <input type="text" id="editHostZone" class="form-control" placeholder="ex: Internal, DMZ, External, Cloud...">
            </div>
            <div class="form-group">
                <label for="editHostCompromiseLevel">Niveau Compromission:</label>
                <select id="editHostCompromiseLevel" class="form-control">
                    <option value="None" selected>None</option>
                    <option value="Initial Access">Initial Access</option>
                    <option value="User">User</option>
                    <option value="Admin/Root">Admin/Root</option>
                    <option value="Domain Admin">Domain Admin</option>
                </select>
            </div>
            <div class="form-group">
                <label for="editHostTechniques">Techniques Exploitation (s√©par√©es par virgule):</label>
                <textarea id="editHostTechniques" class="form-control" rows="2" placeholder="ex: Pass-the-Hash, SMB Relay, SQLi..."></textarea>
            </div>
            <div class="form-group">
                <label for="editHostVulnerabilities">Vuln√©rabilit√©s (s√©par√©es par virgule):</label>
                <textarea id="editHostVulnerabilities" class="form-control" rows="2" placeholder="ex: MS17-010, CVE-2021-44228..."></textarea>
            </div>
            <!-- === FIN DES NOUVEAUX CHAMPS === -->

            <!-- Section Credentials -->
            <h4>Credentials</h4>
            <div id="editCredentialsContainer" class="mb-3"> <!-- Ajout mb-3 -->
                <!-- Les groupes de credentials seront ajout√©s ici par JS avec la nouvelle structure -->
            </div>
            <button type="button" id="addCredentialBtn" class="btn btn-secondary btn-sm mb-3">Ajouter Credential</button>

            <!-- Section Edges -->
            <h4>Connexions Sortantes (Edges)</h4>
            <div class="form-group form-inline mb-2 flex-wrap">
                <label for="editEdgeTo" class="mr-2 mb-1">Vers:</label>
                <input type="text" id="editEdgeTo" placeholder="IP/Nom H√¥te Cible" class="form-control form-control-sm mr-2 mb-1 flex-grow-1">
                <label for="editEdgeLabel" class="mr-2 mb-1">Label:</label>
                <input type="text" id="editEdgeLabel" placeholder="ex: RDP, SSH" class="form-control form-control-sm mr-2 mb-1 flex-grow-1">
                <button type="button" id="addEdgeBtn" class="btn btn-secondary btn-sm mb-1">Ajouter Connexion</button>
            </div>
            <div id="existingEdgesList" class="mb-3">
                <!-- Les edges existants seront list√©s ici par JS -->
            </div>

            <!-- ================================== -->
            <!-- == NOUVELLE SECTION OUTPUTS BRUTS == -->
            <!-- ================================== -->
            <div id="editOutputsSection" class="mt-4 pt-3 border-top"> <!-- Ajout mt-4, pt-3 et border-top pour s√©paration visuelle -->
                <h4>Outputs Bruts & Exploitation</h4>

                <!-- Zone pour afficher les outputs existants et la navigation -->
                <div id="outputNavigation" class="mb-2" style="display: none;">
                    <!-- Les contr√¥les de navigation (onglets, boutons) seront ajout√©s ici par JS -->
                </div>
                <div id="editOutputsContainer" class="mb-3" style="min-height: 50px;">
                    <!-- Les outputs ajout√©s seront affich√©s ici par JS -->
                    <p class="text-muted small no-outputs-msg">Aucun output enregistr√© pour cet h√¥te.</p>
                </div>

                <!-- Zone pour ajouter un nouvel output (initialement cach√©e) -->
                <div id="newOutputInputArea" class="mb-3 p-2 border rounded bg-light" style="display: none;">
                    <h5 id="newOutputTitle" class="mb-2">Ajouter un Output</h5>
                    <div class="form-group mb-2">
                        <label for="newOutputContent" id="newOutputContentLabel">Contenu:</label>
                        <textarea id="newOutputContent" class="form-control form-control-sm" rows="8" placeholder="Collez l'output ici..."></textarea>
                    </div>
                     <div class="form-group mb-2" id="newOutputSubTypeGroup" style="display: none;"> <!-- Pour le type de dump -->
                        <label for="newOutputSubType">Type de Dump:</label>
                        <input type="text" id="newOutputSubType" class="form-control form-control-sm" placeholder="ex: M√©moire LSASS, SAM Hive...">
                    </div>
                    <button type="button" id="saveNewOutputBtn" class="btn btn-success btn-sm mr-2">Enregistrer Output</button>
                    <button type="button" id="cancelNewOutputBtn" class="btn btn-secondary btn-sm">Annuler</button>
                </div>

                <!-- Bouton principal pour ajouter un output -->
                <button type="button" id="addOutputBtn" class="btn btn-info btn-sm mb-2">Ajouter un Output</button>

                <!-- S√©lection du type d'output (initialement cach√©e) -->
                <div id="outputTypeSelection" class="mb-3 p-2 border rounded bg-light" style="display: none;">
                    <p class="mb-1 small font-weight-bold">Choisir le type d'output :</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="Raw">Texte Brut</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="Secretsdump">Secretsdump</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="Mimikatz">Mimikatz</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="WinPEAS">WinPEAS</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="LinPEAS">LinPEAS</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="Dump">Dump (Fichier/M√©moire)</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm m-1" data-output-type="Custom">Custom</button>
                    <button type="button" id="cancelOutputTypeSelectionBtn" class="btn btn-outline-danger btn-sm m-1 float-right" title="Annuler">X</button>
                </div>
            </div>
            <!-- ================================== -->
            <!-- == FIN NOUVELLE SECTION OUTPUTS == -->
            <!-- ================================== -->

            <!-- ======================================== -->
            <!-- == NOUVELLE SECTION √âTAPES EXPLOITATION == -->
            <!-- ======================================== -->
            <div id="exploitationStepsSection" class="mt-4 pt-3 border-top">
                <h4>√âtapes d'Exploitation</h4>
                <div id="exploitationStepsList" class="list-group mb-3">
                    <!-- Les √©tapes seront list√©es ici par JS -->
                    <p class="text-muted small no-exploitation-steps-msg">Aucune √©tape d'exploitation enregistr√©e pour cet h√¥te.</p>
                </div>
                <button type="button" id="addExploitationStepBtn" class="btn btn-secondary btn-sm mb-3">
                    <i class="icon-plus"></i> Ajouter une √âtape
                </button>
            </div>
            <!-- ======================================== -->
            <!-- == FIN SECTION √âTAPES EXPLOITATION == -->
            <!-- ======================================== -->

            <!-- Boutons d'action -->
            <div class="edit-panel-actions">
                <button type="submit" class="btn btn-primary">Sauvegarder Modifications</button>
                <button type="button" id="deleteHostFromPanelBtn" class="btn btn-danger">Supprimer cet H√¥te</button>
            </div>
        </form>
    </div>

    <!-- MODALE POUR LES D√âTAILS D'UNE √âTAPE D'EXPLOITATION (Initialement cach√©e) -->
    <div class="modal fade" id="exploitationStepDetailModal" tabindex="-1" aria-labelledby="exploitationStepDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg"> <!-- modal-lg pour plus d'espace -->
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exploitationStepDetailModalLabel">D√©tails de l'√âtape</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="exploitationStepDetailForm">
                        <input type="hidden" id="stepDetailModalStepId">
                        <div class="form-group row">
                            <label for="stepDetailModalOrder" class="col-sm-2 col-form-label">Ordre:</label>
                            <div class="col-sm-3">
                                <input type="number" class="form-control form-control-sm" id="stepDetailModalOrder" min="1" step="1" required>
                            </div>
                             <label for="stepDetailModalTitle" class="col-sm-1 col-form-label">Titre:</label>
                             <div class="col-sm-6">
                                <input type="text" class="form-control form-control-sm" id="stepDetailModalTitle" placeholder="Ex: Scan Initial, Escalade Privil√®ges..." required>
                             </div>
                        </div>
                        <div class="form-group">
                            <label for="stepDetailModalContent">Contenu (Commandes, Notes, etc.):</label>
                            <textarea class="form-control" id="stepDetailModalContent" rows="10" placeholder="D√©taillez les commandes ex√©cut√©es, les r√©sultats importants, les observations..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="stepDetailModalScreenshotUrl">URL/Chemin Capture d'√©cran (Optionnel):</label>
                            <input type="text" class="form-control form-control-sm" id="stepDetailModalScreenshotUrl" placeholder="Ex: /screenshots/step1.png ou http://.../image.jpg">
                        </div>
                        <div id="stepDetailModalScreenshotPreview" class="mt-2" style="max-height: 200px; overflow: auto;">
                            <!-- L'aper√ßu de l'image sera charg√© ici si une URL est valide -->
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="button" id="saveExploitationStepBtn" class="btn btn-primary">Sauvegarder √âtape</button>
                </div>
            </div>
        </div>
    </div>
    <!-- FIN MODALE -->

    <!-- Panneau Param√®tres Cat√©gorie (Initialement cach√©) -->
    <!-- Plac√© HORS de main-content -->
    <div id="categorySettingsPanel" class="edit-panel category-settings-panel">
        <button id="closeCategorySettingsPanelBtn" class="close-panel-btn" title="Fermer">&times;</button>
        <h3 id="categorySettingsPanelTitle">Param√®tres Cat√©gorie</h3>
        <form id="categorySettingsForm">
            <input type="hidden" id="settingsCategoryName">
            <div class="form-group">
                <label for="categoryTemplateTypeSelect">Type de Template Associ√©:</label>
                <select id="categoryTemplateTypeSelect" class="form-control">
                    <option value="">Aucun</option>
                </select>
                <small class="form-text text-muted">Affecte le template utilis√© lors de la g√©n√©ration du rapport Killchain...</small>
            </div>
            <button type="button" id="saveCategorySettingsBtn" class="btn btn-primary">Sauvegarder Param√®tres</button>
        </form>
    </div>

    <!-- Footer (Structure identique √† grepmaster.html) -->
    <footer class="main-footer">
        <div class="footer-content">
            <p>Made with ‚ù§Ô∏è by Elliot Belt</p>
        </div>
    </footer>

    <!-- Scripts JS -->
    <!-- jQuery (Doit √™tre charg√© AVANT Bootstrap JS) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <!-- Popper.js (Requis par Bootstrap JS pour les tooltips, popovers, etc.) -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <!-- Bootstrap JS (D√©pend de jQuery et Popper.js) -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Vos autres scripts -->
    <script src="/assets/js/sidebar.js"></script> <!-- Pour la sidebar -->
    <script src="/assets/js/theme.js"></script>   <!-- Pour le th√®me -->
    <script src="/assets/js/language.js"></script> <!-- Pour la langue (si utilis√©) -->
    <script type="module" src="/assets/js/hostmanager/main.js"></script>

    <!-- Assurez-vous que JSZip et FileSaver sont inclus -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <!-- Modal de rapport Kill Chain -->
    <div class="modal fade" id="reportModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">üéØ Rapport Kill Chain</h5>
                    <div class="btn-group ml-auto mr-3">
                        <button type="button" id="exportPdfBtn" class="btn btn-success btn-sm">
                            <i class="fas fa-file-pdf"></i> üìÑ Export PDF
                        </button>
                        <button type="button" id="exportMdBtn" class="btn btn-info btn-sm">
                            <i class="fas fa-file-alt"></i> üìù Export MD
                        </button>
                    </div>
                    <button type="button" class="close" data-dismiss="modal">
                        <span>&times;</span>
                    </button>
                </div>
                <div class="modal-body p-0">
                    <!-- Onglets -->
                    <ul class="nav nav-tabs" style="margin: 0;">
                        <li class="nav-item">
                            <a class="nav-link" id="editorTab" href="#" style="border-radius: 0;">
                                ‚úèÔ∏è √âditeur
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" id="previewTab" href="#" style="border-radius: 0;">
                                üëÅÔ∏è Aper√ßu
                            </a>
                        </li>
                    </ul>
                    
                    <!-- Contenu des onglets -->
                    <div class="tab-content">
                        <!-- √âditeur Markdown -->
                        <textarea id="reportEditor" class="form-control" 
                                  style="display: none; height: 70vh; border: none; border-radius: 0; resize: none; font-family: 'Courier New', monospace;"
                                  placeholder="Le rapport sera g√©n√©r√© ici..."></textarea>
                        
                        <!-- Aper√ßu rendu -->
                        <div id="renderedPreview" 
                             style="height: 70vh; overflow-y: auto; border: none; background: white; padding: 0;">
                            <div class="text-center text-muted p-5">
                                <i class="fas fa-file-alt fa-3x mb-3"></i>
                                <p>G√©n√©rez un rapport pour voir l'aper√ßu</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vis.js pour la carte r√©seau -->
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.5/purify.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

</body>
</html>